@inject IConfiguration Configuration;
@using DigitalLearningSolutions.Web.ViewModels.TrackingSystem.Delegates.DelegateGroups
@using Microsoft.Extensions.Configuration
@model GroupCourseRemoveViewModel

@{
  var errorHasOccurred = !ViewData.ModelState.IsValid;
  ViewData["Title"] = "Groups - Remove group course";
}

<div class="nhsuk-grid-row">
  <div class="nhsuk-grid-column-full">
    @if (errorHasOccurred) {
      <vc:error-summary order-of-property-names="@(new[] { nameof(Model.Confirm), nameof(Model.DeleteStartedEnrolments) })" />
    }

    <h1 class="nhsuk-heading-xl nhsuk-u-margin-bottom-8">Are you sure you would like to remove @Model.CourseName course from this group?</h1>
  </div>
</div>

<div class="nhsuk-grid-row">
  <div class="nhsuk-grid-column-full nhsuk-lede-text">
    All delegate enrolments that have not yet been started and are associated with the membership of this group will be removed.
  </div>
</div>

<div class="nhsuk-grid-row">
  <div class="nhsuk-grid-column-one-quarter nhsuk-heading-l nhsuk-u-font-weight-bold">
    Group name:
  </div>
  <div class="nhsuk-grid-column-three-quarters nhsuk-heading-l nhsuk-u-font-weight-normal word-break">
    @Model.GroupName
  </div>
</div>

<div class="nhsuk-grid-row">
  <div class="nhsuk-grid-column-full">
    <form class="nhsuk-u-margin-bottom-3" method="post"
          asp-action="GroupCourseRemove"
          asp-route-groupCustomisationid="@Model.CourseId">

      <input type="hidden" asp-for="CourseId" />
      <input type="hidden" asp-for="CourseName" />
      <input type="hidden" asp-for="GroupName" />

      <vc:single-checkbox asp-for="@nameof(Model.Confirm)"
                          label="I am sure that I wish to remove @Model.CourseName course from this group."
                          hint-text="" />

      <vc:single-checkbox asp-for="@nameof(Model.DeleteStartedEnrolments)"
                          label="Remove all related enrolments where course has been started but is not yet complete."
                          hint-text="Optionally, all enrolments on this course that have been started but are incomplete can also be removed, if they're associated with the membership of this group." />

      <button class="nhsuk-button delete-button" type="submit">Remove course</button>
    </form>

    @{
      var routeData = new Dictionary<string, string> {
        { "groupId", ViewContext.RouteData.Values["groupId"].ToString()! }
      };
    }

    <vc:cancel-link asp-controller="DelegateGroups" asp-action="GroupCourses" asp-all-route-data="@routeData" />
  </div>
</div>
