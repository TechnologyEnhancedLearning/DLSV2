@using DigitalLearningSolutions.Web.ViewModels.Frameworks;
@model CompetencyResourceSignpostingViewModel

<link rel="stylesheet" href="@Url.Content("~/css/frameworks/frameworksShared.css")" asp-append-version="true">

@section NavMenuItems {
  <partial name="Shared/_NavMenuItems" />
}
@section NavBreadcrumbs {
  <nav class="nhsuk-breadcrumb" aria-label="Breadcrumb">
    <div class="nhsuk-width-container">
      <ol class="nhsuk-breadcrumb__list">
        <li class="nhsuk-breadcrumb__item"><a class="nhsuk-breadcrumb__link trigger-loader" asp-action="ViewFrameworks" asp-route-tabname="Mine">Frameworks</a></li>
        <li class="nhsuk-breadcrumb__item"><a class="nhsuk-breadcrumb__link trigger-loader" asp-action="ViewFramework" asp-fragment="fc-@Model.FrameworkCompetencyId" asp-route-frameworkId="@Model.FrameworkId" asp-route-tabname="Structure">Framework Structure</a></li>
        <li class="nhsuk-breadcrumb__item"><a class="nhsuk-breadcrumb__link trigger-loader" asp-action="EditCompetencyLearningResources" asp-route-frameworkId="@Model.FrameworkId" asp-route-frameworkCompetencyId="@Model.FrameworkCompetencyId" asp-route-frameworkCompetencyGroupId="@Model.FrameworkCompetencyGroupId">Signposting</a></li>
        <li class="nhsuk-breadcrumb__item">Add Resource</li>
      </ol>
      <p class="nhsuk-breadcrumb__back"><a class="nhsuk-breadcrumb__backlink" asp-action="EditCompetencyLearningResources" asp-route-frameworkId="@Model.FrameworkId" asp-route-frameworkCompetencyId="@Model.FrameworkCompetencyId" asp-route-frameworkCompetencyGroupId="@Model.FrameworkCompetencyGroupId">Back to Signposting</a></p>
    </div>
  </nav>
}
<h1>Add Competency Learning Resource</h1>
<div class="nhsuk-inset-text">
  <span class="nhsuk-u-visually-hidden">Information: </span>
  <p>
    @Model.NameOfCompetency
  </p>
</div>
<form method="post" role="search" asp-controller="Frameworks" asp-action="SearchLearningResources">
  <h2>Search the Learning Hub</h2>
  <div class="nhsuk-grid-row">
    <div class="nhsuk-grid-column-three-quarters">
      <div class="search-box-container" id="search">
        @Html.LabelFor(m => m.SearchText, "Search", new { @class = "nhsuk-u-visually-hidden", @for = "search-field" })
        @Html.TextBoxFor(m => m.SearchText, new { @class = "search-box", id = "search-field", name = "searchString", type = "search", placeholder = "Search", autocomplete = "off" })
        <button class="nhsuk-search__submit sort-submit" type="submit">
          Search
        </button>
      </div>
    </div>
  </div>
  <input id="FrameworkId" name="FrameworkId" type="hidden" value="@Model.FrameworkId" />
  <input id="FrameworkCompetencyGroupId" name="FrameworkCompetencyGroupId" type="hidden" value="@Model.FrameworkCompetencyGroupId" />
  <input id="FrameworkCompetencyId" name="FrameworkCompetencyId" type="hidden" value="@Model.FrameworkCompetencyId" />
  <input id="NameOfCompetency" name="NameOfCompetency" type="hidden" value="@Model.NameOfCompetency" />
  <input id="SearchText" name="SearchText" type="hidden" value="@Model.SearchText" />
  <input id="Page" name="Page" type="hidden" value="@Model.Page" />
</form>
@if (Model.LearningHubApiError)
{
  <span class="nhsuk-u-margin-1 nhsuk-u-clear">This service is unavailable. Please try again later.</span>
}
else if (Model.SearchResult?.Results != null)
{
  <span class="nhsuk-u-margin-1 nhsuk-u-clear">@Model.TotalNumResources matches for "@Model.SearchText"</span>
  @foreach (var result in Model.SearchResult.Results)
  {
    <partial name="Developer/_SignPostingResourceCard" model="result" />
  }
}
<div class="nhsuk-back-link nhsuk-u-margin-left-1">
  <a class="nhsuk-back-link__link" asp-action="EditCompetencyLearningResources" asp-route-frameworkId="@Model.FrameworkId" asp-route-frameworkCompetencyId="@Model.FrameworkCompetencyId" asp-route-frameworkCompetencyGroupId="@Model.FrameworkCompetencyGroupId">
    <svg class="nhsuk-icon nhsuk-icon__chevron-left" focusable='false' xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
      <path d="M13.41 12l5.3-5.29a1 1 0 1 0-1.42-1.42L12 10.59l-5.29-5.3a1 1 0 0 0-1.42 1.42l5.3 5.29-5.3 5.29a1 1 0 0 0 0 1.42 1 1 0 0 0 1.42 0l5.29-5.3 5.29 5.3a1 1 0 0 0 1.42 0 1 1 0 0 0 0-1.42z"></path>
    </svg>
    Cancel
  </a>
</div>
@if (Model.TotalPages > 1)
{
  <partial name="Developer/_SignpostingPaginationNav" model="Model" />
}
