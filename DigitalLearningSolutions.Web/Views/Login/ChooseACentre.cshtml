@using DigitalLearningSolutions.Web.ViewModels.Login
@model ChooseACentreViewModel
@{
  ViewData["Title"] = "Choose A Centre";
}

<link rel="stylesheet" href="@Url.Content("~/css/login/chooseACentre.css")" asp-append-version="true">

@section NavMenuItems {
  <partial name="_NavMenuItems" />
}

<div class="nhsuk-grid-row">
  <div class="nhsuk-grid-column-full">

    <h1 id="page-heading" class="nhsuk-heading-xl">Choose a centre</h1>
    <p class="nhsuk-body-l">
      Please choose the centre you would like to sign in to.
    </p>

    @if (Model.CentreUserDetails.Any(centreRow => centreRow.IsDelegateUnapproved)) {
      <vc:inset-text css-class="" text="You have an unapproved delegate account. You will receive an email at the address you registered with when your registration has been approved." />
    }

    @if (Model.CentreUserDetails.Count > 1) {
      <table role="table" class="nhsuk-table-responsive">
        <thead role="rowgroup" class="nhsuk-table__head">
        <tr role="row">
          <th role="columnheader" scope="col">
            Centre
          </th>
          <th role="columnheader" scope="col" class="centre-status-th">
            Status
          </th>
          <th role="columnheader" scope="col">
            Roles
          </th>
          <th role="columnheader" scope="col">
            Action
          </th>
        </tr>
        </thead>
        <tbody class="nhsuk-table__body">
        @foreach (var centreRow in Model.CentreUserDetails) {
          <tr role="row" class="nhsuk-table__row">
            <td role="cell" class="nhsuk-table__cell choose-centre-td">
              <span class="nhsuk-table-responsive__heading">Centre: </span>
              @centreRow.CentreName
            </td>
            <td role="cell" class="nhsuk-table__cell choose-centre-td">
              <span class="nhsuk-table-responsive__heading">Status: </span>
              <strong class="nhsuk-tag nhsuk-tag--@centreRow.StatusTag["Colour"]">@centreRow.StatusTag["Label"]</strong>
            </td>
            <td role="cell" class="nhsuk-table__cell choose-centre-td">
              <span class="nhsuk-table-responsive__heading">Roles: </span>
              <div class="centre-role-tags">
                @if (centreRow.IsAdmin) {
                  <strong class="nhsuk-tag nhsuk-tag--blue centre-role-tag">Admin</strong>
                }
                @if (centreRow.IsDelegate) {
                  <strong class="nhsuk-tag nhsuk-tag--grey centre-role-tag">Delegate</strong>
                }
              </div>
            </td>
            <td role="cell" class="nhsuk-table__cell choose-centre-td">
              @if (centreRow.ActionButton == "Choose") {
                <form method="POST" asp-action="ChooseCentre">
                  <input type="hidden" name="centreId" value="@centreRow.CentreId" />
                  <button type="submit" class="nhsuk-button nhsuk-u-margin-bottom-3 nhsuk-u-padding-bottom-0 nhsuk-u-padding-top-0 nhsuk-u-margin-top-0">
                    Choose <span class="nhsuk-u-visually-hidden">@centreRow.CentreName</span>
                  </button>
                </form>
              } else if (centreRow.ActionButton == "Reactivate") {
                @* TODO HEEDLS-906: Link to Reactivate centre account page *@
                <button class="nhsuk-button nhsuk-u-margin-bottom-3 nhsuk-u-padding-bottom-0 nhsuk-u-padding-top-0 nhsuk-u-margin-top-0">
                  Reactivate <span class="nhsuk-u-visually-hidden">@centreRow.CentreName</span>
                </button>
              }
            </td>
          </tr>
        }
        </tbody>
      </table>
    } else {
      <p>You have no centre accounts.</p>
    }

    @* TODO HEEDLS-879: Link to Switch centre page *@
    <a role="button" class="nhsuk-button nhsuk-button--secondary nhsuk-u-margin-top-4 nhsuk-u-margin-top-0">
      Register at a new centre
    </a>
  </div>
</div>
