@using DigitalLearningSolutions.Web.ViewModels.Register
@model ClaimAccountViewModel

@{
  ViewData["Title"] = "Complete delegate registration";
}

<div class="nhsuk-grid-row">
  <div class="nhsuk-grid-column-full">

    <h1 class="nhsuk-heading-l" id="app-page-heading">
      Complete delegate registration
    </h1>

    <p class="nhsuk-body-m">You have been registered for a new account.</p>

    <dl class="nhsuk-summary-list--no-border nhsuk-body-m">
      <div class="nhsuk-summary-list__row basic-summary-list__row">
        <dt class="nhsuk-summary-list__key">
          Centre:
        </dt>
        <partial name="_SummaryFieldValue" model="@Model.CentreName" />
      </div>
      <div class="nhsuk-summary-list__row basic-summary-list__row">
        <dt class="nhsuk-summary-list__key">
          Account email:
        </dt>
        <partial name="_SummaryFieldValue" model="@Model.CentreSpecificEmail" />
      </div>
    </dl>

    @if (Model.EmailIsTaken) {
      if (Model.EmailIsTakenByActiveUser) {
        <p class="nhsuk-body-m">
          A DLS user account is already registered with this email address. If that account belongs to you, you can link this delegate record to your login.
        </p>

        <vc:action-link asp-controller="ClaimAccount" asp-action="LinkDlsAccount" link-text="Link this record" />
      } else {
        <p class="nhsuk-body-m">
          The DLS user account associated with this email address is inactive. To request reactivation of the account, please contact <a href="mailto:@Model.SupportEmail">@Model.SupportEmail</a>.
        </p>
      }
    } else {
      <p class="nhsuk-body-m">
        If you already have an account on DLS, we recommend that you link your new account to your existing login.
      </p>

      <vc:action-link asp-controller="ClaimAccount" asp-action="LinkDlsAccount" link-text="Use existing login" />

      <p class="nhsuk-body-m">
        Otherwise, you can create a new login.
      </p>

      var routeData = new Dictionary<string, string> {
        { "email", Model.Email },
        { "code", Model.RegistrationConfirmationHash },
      };

      <vc:action-link
        asp-controller="ClaimAccount"
        asp-action="CompleteRegistration"
        asp-all-route-data="@routeData"
        link-text="Create a new login" />
    }

  </div>
</div>
