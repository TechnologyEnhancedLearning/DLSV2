@using DigitalLearningSolutions.Web.ViewModels.LearningPortal.SelfAssessments
@model AddSupervisorViewModel
@*@using Microsoft.Extensions.Configuration
@inject IConfiguration Configuration*@

@{
    var errorHasOccurred = !ViewData.ModelState.IsValid;
    Layout = "SelfAssessments/_Layout";
    ViewData["Title"] = "Self Assessment";
    ViewData["SelfAssessmentTitle"] = @Model.SelfAssessmentName;

    //ViewData["HeaderPath"] = $"{Configuration["AppRootPath"]}/LearningPortal/SelfAssessment";
    //ViewData["HeaderPathName"] = "LearningPortal/SelfAssessment";
}
@section breadcrumbs {
    <li class="nhsuk-breadcrumb__item">
        <a class="nhsuk-breadcrumb__link" asp-action="SelfAssessment" asp-route-selfAssessmentId="@Model.SelfAssessmentID">@Model.SelfAssessmentName</a>
    </li>
    <li class="nhsuk-breadcrumb__item">
        <a class="nhsuk-breadcrumb__link" asp-action="ManageSupervisors" asp-route-selfAssessmentId="@Model.SelfAssessmentID">Manage Supervisors</a>
    </li>
    <li class="nhsuk-breadcrumb__item">Add</li>
}
@if (Model.JavascriptSearchSortFilterPaginateEnabled)
{
  <vc:loading-spinner page-has-side-nav-menu="false" />
}
@section mobilebacklink
    {
    <p class="nhsuk-breadcrumb__back">
      @if(TempData["CentreID"] == null)
      {
        <a class="nhsuk-breadcrumb__backlink" asp-action="ManageSupervisors" asp-route-selfAssessmentId="@Model.SelfAssessmentID">Back to Manage Supervisors</a>
      }
      else
      {
        <a class="nhsuk-breadcrumb__backlink" asp-action="SelectSupervisorCentre" asp-route-selfAssessmentId="@Model.SelfAssessmentID">Back to Choose a centre</a>
      }
    </p>
}
<link rel="stylesheet" href="@Url.Content("~/css/learningPortal/selfAssessment.css")" asp-append-version="true">
<h1>New activity supervisor</h1>
<div class="nhsuk-grid-row">
    <div class="nhsuk-grid-column-full">
        <form method="get" role="search" asp-route-page="@Model.Page">
            @if (errorHasOccurred)
            {
                <vc:error-summary order-of-property-names="@(new[] {nameof(Model.SupervisorAdminID) })" />
            }
            <div class="nhsuk-grid-row">
                <partial name="SearchablePage/_Search" model="Model" />
            </div>
            <nhs-form-group nhs-validation-for="SupervisorAdminID">
                <fieldset class="nhsuk-fieldset">
                    <input type="hidden" asp-for="SelfAssessmentID" value="@Model.SelfAssessmentID" />
                    <input type="hidden" asp-for="SelfAssessmentName" value="@Model.SelfAssessmentName" />
                    <input type="hidden" asp-for="Supervisors" value="@Model.Supervisors" />
                    <legend class="nhsuk-fieldset__legend nhsuk-fieldset__legend--l">
                        <h2 class="nhsuk-fieldset__heading">
                            Choose a supervisor
                        </h2>
                    </legend>
                    <div class="nhsuk-hint" id="contact-hint">
                        Select your supervisor from the list below. If your supervisor is not listed, they will need to be given supervisor access by an administrator.
                    </div>

                    @if (errorHasOccurred)
                    {
                        <div class="nhsuk-u-padding-top-1 nhsuk-u-padding-bottom-3">
                            <span class="error-message--margin-bottom-1 nhsuk-error-message">
                                <span>@Html.ValidationMessageFor(x=>x.SupervisorAdminID)</span>
                            </span>
                        </div>
                    }
                    <partial name="SearchablePage/_SearchResultsCount" model="Model" />
                    <partial name="SearchablePage/_TopPagination" model="Model" />
                    <partial name="SearchablePage/_ResultCountAndPageAlerts" model="Model" />

                    <input type="hidden" aria-hidden="true" id="select-sort-by" value="SearchableName" />
                    <input type="hidden" aria-hidden="true" id="select-sort-direction" value="Ascending" />

                    <div id="SupervisorAdminID" class="nhsuk-radios">
                        @foreach (var supervisor in Model.Supervisors)
                        {
                            <div class="nhsuk-radios__item">
                                <input class="nhsuk-radios__input" id="supervisor-@supervisor.AdminID" name="SupervisorAdminID" type="radio" checked="@(supervisor.AdminID == Model.SupervisorAdminID)" value="@supervisor.AdminID" aria-describedby="supervisor-@supervisor.AdminID-item-hint">
                                <label class="nhsuk-label nhsuk-radios__label" for="supervisor-@supervisor.AdminID">
                                    @supervisor.Forename @supervisor.Surname (@supervisor.CentreName)
                                </label>
                                <div class="nhsuk-hint nhsuk-radios__hint" id="supervisor-@supervisor.AdminID-item-hint">
                                    @supervisor.Email
                                </div>
                            </div>
                        }
                    </div>
                    <partial name="SearchablePage/_BottomPagination" model="Model" />
                </fieldset>
            </nhs-form-group>
        </form>
        <form method="post" >
            @if (Model.Supervisors.Count() > 0)
            {
                @*<button class="nhsuk-button" type="submit">
                    Next
                </button>*@
                <button class="nhsuk-button" type="submit" >
            Submit
          </button>
            }
            @Html.HiddenFor(m => m.SearchString)
            @Html.HiddenFor(m => m.SortBy)
            @Html.HiddenFor(m => m.SortDirection)
            @Html.HiddenFor(m => m.Page)
        </form>
    </div>
</div>
<div class="nhsuk-back-link">
    <a class="nhsuk-back-link__link"
       asp-action="ManageSupervisors"
       asp-route-selfAssessmentId="@ViewContext.RouteData.Values["selfAssessmentId"]">
        <svg class="nhsuk-icon nhsuk-icon__chevron-left" focusable='false' xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path d="M13.41 12l5.3-5.29a1 1 0 1 0-1.42-1.42L12 10.59l-5.29-5.3a1 1 0 0 0-1.42 1.42l5.3 5.29-5.3 5.29a1 1 0 0 0 0 1.42 1 1 0 0 0 1.42 0l5.29-5.3 5.29 5.3a1 1 0 0 0 1.42 0 1 1 0 0 0 0-1.42z"></path>
        </svg>
        Cancel
    </a>
</div>
@if (Model.JavascriptSearchSortFilterPaginateEnabled)
{
  @section scripts {
  <script src="@Url.Content("~/js/LearningPortal/supervisorList.js")" asp-append-version="true"></script>
}
}
